# It uses a delimiter of | 

# Path to your names file
$MappingFile = "C:\path\to\names.txt"

# Path to the folder containing the files to rename
$TargetFolder = "C:\path\to\files"

# Read each line from the mapping file
Get-Content $MappingFile | ForEach-Object {
    # Skip empty lines
    if ($_ -match "^\s*$") { return }

    # Split into new name and old name
    $parts = $_ -split "\|"
    if ($parts.Count -ne 2) {
        Write-Host "Skipping invalid line: $_" -ForegroundColor Yellow
        return
    }

    $newNameBase = $parts[0].Trim()
    $oldNameBase = $parts[1].Trim()

    # Find the actual old file in the target folder (case-insensitive match)
    $oldFile = Get-ChildItem -Path $TargetFolder | Where-Object {
        $_.BaseName -ieq $oldNameBase
    }

    if ($oldFile) {
        $newFileName = "$newNameBase$($oldFile.Extension)"
        Rename-Item -Path $oldFile.FullName -NewName $newFileName
        Write-Host "Renamed '$($oldFile.Name)' -> '$newFileName'" -ForegroundColor Green
    } else {
        Write-Host "File not found for: $oldNameBase" -ForegroundColor Red
    }
}